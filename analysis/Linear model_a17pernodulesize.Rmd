---
title: "linear model_a17pernodulesize"
author: "sohini guha"
date: '2022-10-29'
output: html_document
---
```{r setup, include=FALSE}
#
knitr::opts_chunk$set(echo = TRUE)

#Set up all the packages you will need. Tidyverse include dplyer
require(tidyverse)
require(ggpubr)

knitr::opts_chunk$set(message = FALSE)
```
```{r Importing Data and Running a Linear Model, echo=TRUE}

# Import the text file of nodule data
data_HostMutants2021_nod_counts <- read.table("../data/data_HostMutants2021_nod_counts.txt",sep = "\t",header=TRUE)
# Import the genotype information data
genotype_name <- read.table("../data/genotype_name.txt",sep = "\t",header=TRUE)

#convert the genotype_id into integer
genotype_name$genotype_id = as.integer(genotype_name$genotype_id)

#merge the two data set by 'genotype_id'
all.data<- full_join (data_HostMutants2021_nod_counts, genotype_name, by = "genotype_id")

#Select for only the A17 background 
all.data.A17 <- all.data %>% filter(background=="A17")

# Remove two genotypes that did not survive/form nodules... Use the '!=' this time which says to grab all of the them BUT the named genotype ID.
all.data.A17 <- all.data.A17 %>% filter(genotype_id!="853")
all.data.A17 <- all.data.A17 %>% filter(genotype_id!="838")
# Remove 833B
all.data.A17 <- all.data.A17 %>% filter(sample_id!="833B")
```
```{r Running a Linear Model, echo=TRUE}
#Turning all.data.A17$name  into a factor.
all.data.A17$name<-factor(all.data.A17$name)
#Turning all.data.A17$Type into a factor.
all.data.A17$type<-factor(all.data.A17$type, levels = c("WT","Early","Late","AON"))
# Running the model1
model1 <- lm(average_size ~ name + rep, data = all.data.A17)
#Examine the summary
summary(model1)
#Examine the Analysis of Variance table
anova(model1)
# Running the model2
model1 <- lm(average_size ~ type + rep, data = all.data.A17)
#Examine the summary
summary(model1)
#Examine the Analysis of Variance table
anova(model1)
```

